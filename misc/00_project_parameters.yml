global: ## Global parameters are those who are the samee across all study cases
  dir: ## Directories
    main: "~/RNAseqMVA"
    workspace: "~/RNAseqMVA_workspace"
    results: "~/RNAseqMVA_workspace/results"
    TSV: "~/RNAseqMVA_workspace/data"
    memoryImages: "~/RNAseqMVA_workspace/memory_images"

  perm.prefix: "permLabels"
  jobs: "none" ## Maximal number of jobs to run in parallel. Supported: integers > 0, "auto", or "none"
  #  iterations: 50, ## Number of iterations for the classiifers
  iterations: 10 ## Number of iterations for the classiifers

  reload: FALSE
  compute: TRUE ## If FALSE, do not run the heavy computations, just generate the pictures and save tables
  save.tables: TRUE ## If TRUE, save tab-delimited files with the results
  save.image: FALSE
  draw.plot : TRUE
  classifiers: "rf"
  # classifiers: ["svm", "knn","rf"]
  # classifiers: ["knn","rf","svm"] # TO ADD LATER: "lda", "qda" + the one suggested by Aitor

  data.types: ["countsPerRun", "originalCounts", "filtered", "norm", "log2norm", "log2normPCs", "DEG", "V.importance"]
  data.types.to.test: ["log2normPCs"]
  # data.types.to.test: ["filtered", "norm", "log2norm", "log2normPCs"]

  # data.types.to.test: ["log2norm"]
  variables.type: ["all", "top_ordered"]
  deg.methods: ["DESeq2", "edgeR"]
  ## Note: for the number of variables I choose a regular spacing around the total number of samples in order to detect overfitting effects
  nb.variables: [3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 300, 400, 500, 1000, 2000, 5000, 10000] ## Number of variables for variable ordering test
  trainingProportion: [0.66] # ratio of spliting the data set to training and testing sets
  identicalTrainTest: TRUE
  permute: [FALSE, TRUE]
  verbose: TRUE

  knn:
    k: 10
    k_values: [3, 5, 7, 10, 15]

  svm:
    kernel: "linear"
    kernel_values: ["linear", "polynomial", "sigmoid"] ## NOT WORKING YET, TO BE TESTED LATER: "radial basis"
    scale: FALSE
    type: "C-classification"
  # type: ["C-classification", "nu-classification", "one-classification"]
    gamma: 1
    cost: 100

  rf:
    ntree: [1000, 2000, 3000, 4000] # Number of trees to grow, to ensure that every input row gets predicted at least a few times. by default that is 500.
    mtry: [500, 600, 700, 800] # number of variables randomly sampled as candidates at each split. wherein the default value is sqrt(number of variables in recount dataset) here is around ~ 235
    nodesize: [5000, 10000, 20000, 30000]  # minimum size of terminal nodes, wherein by setting it number larger causes smaller trees to be grown (and thus take less time)

## Default values for study case-specific parameters
## (can then be over-written by recountID-specific values as shown below)
default:
  #  classColumn: "tissue" ## Characteristics to be used as class label
  mergeRuns: TRUE ## Whether or not to merge runs per sample
  sampleIdColumn: "geo_accession"

  ## Filtering options
  minSamplesPerClass: 15 ## THERE IS A BUG TO FIX: if we set this parameter to 10 (for example) the class labels must be adapted by suppressing the
  nearZeroVarFilter: TRUE
  na.rm: TRUE



## Project-specific parameters for the analysis of Recount RNA-seq datasets
SRP042620:
  geoSeries: "GSE58135"
  description: "Multi-group breast cancer"
  classColumn: "tissue"
  classColors:
      Breast.Cancer.Cell.Line: "red"
      ER..Breast.Cancer.Primary.Tumor: "darkblue"
      Triple.Negative.Breast.Cancer.Primary.Tumor: "purple"
      Uninvolved.Breast.Tissue.Adjacent.to.ER..Primary.Tumor: "green"
      Uninvolved.Breast.Tissue.Adjacent.to.TNBC.Primary.Tumor: "black"

SRP057196:
  description: "individual cells into all of the major neuronal, glial, and vascular cell types in the brain"
  classColumn: ["tissue", "cell.type"] ## MUSTAFA: IT IS IMPORTANT TO COMBINE THE TWO COLUMNS, THIS IS THE ESSENCE OF THIS DATASET !!!
  classColors:
      cortex_fetal_quiescent: "red"
      cortex_fetal_replicating: "darkblue"
      cortex_astrocytes: "purple"
      cortex_neurons: "green"
      cortex_hybrid: "black"
      cortex_oligodendrocytes: "cyan"
      cortex_endothelial: "darkgoldenrod1"
      cortex_microglia: "aquamarine4"
      cortex_OPC: "burlywood4"


SRP056295: ## 525 runs, human leukemia
  description: "525 runs, human leukemia"
  classColumn: "tissue"

SRP035988:  ## Psoriasis
  description: "Psoriasis"
  classColumn: "tissue.type"

ERP003613: # Tissue samples from 95 human individuals
  description: "RNA-seq was performed of tissue samples from 95 human individuals representing 27 different tissues in order to determine tissue-specificity of all protein-coding genes.	"
  short_description: "tissue samples from 95 human individuals, 27 different tissues.	"

SRP061240: ## Cancer disease types ("Pancreatic", " colorectal", "prostat Cancer", "Healthy control")
  description: "Extracellular vesicles such as exosomes are selectively enriched in RNA that has potential for use as disease biomarkers. To systemically characterize circulating extracellular RNA profiles, we performed RNA sequencing analysis on plasma extracellular vesicles derived from 192 individuals including 100 colon cancer, 36 prostate cancer and 6 pancreatic cancer patients along with 50 healthy individuals. Of ~12.6 million raw reads for each of these subjects, the number of mappable reads aligned to RNA references was ~5.4 million including microRNAs(miRNAs) (~40.4%), piwi-interacting RNAs(piwiRNAs) (~40.0%), pseudo-genes (~3.7%), long noncoding RNAs (lncRNAs) (~2.4%), tRNAs (~2.1%), and mRNAs (~2.1%). To select the best candidates for potential extracellular RNA reference controls, we performed abundant level stability testing and identified a set of miRNAs showing relatively consistent expression. To estimate biological variations, we performed association analysis of expression levels with age and sex in healthy individuals. This analysis showed significant sex association with seven small noncoding RNAs (false discovery rate, or FDR<0.05), while no small noncoding RNAs were statistically associated with age. To identify disease-associated RNA transcripts, we performed analysis of covariance by including disease status, age, sex, RNA isolation and gel size selection dates. We observed a gradual increase of significantly associated RNAs (in particular, miRNAs) with disease advancement as denoted by cancer staging. We found significant association of miR-125a-5p and miR-1246-3p with all cancer types tested (FDR<0.05). Based on the disease associations, we developed cancer type-specific multivariate statistical models to predict disease status with an area under the ROC curve from 0.67 in stage I colon cancer to 0.92 in advanced prostate cancer. To date, this is the largest RNA-seq study to systematically profile extracellular RNA species, which has not only provided a baseline reference profile for circulating extracellular RNA, but also a set of RNA candidates for reference controls and disease biomarkers. Overall design: RNAs fro plasma circulating microviscles in 192 individuals were sequenced and quantified. RNA expression stability testing was performed to identify stably expressed RNAs. Distribution of RNA species and individual RNA transcripts were compared in normal and cancer patients.	"
  short_description: "Plasma extracellular vesicles from 192 human individuals including colon cancer, prostate cancer and pancreatic cancer and healthy individuals. "
  classColumn: "disease.type"


SRP062966:
  descrition: "blood disease"
  classColumn: "disease.status"

## PROBLEM: after run merging, there are only  a handful of samples left.
## TO DO: Check the original publication.
## SRP003611:
##  description: "transcriptomes of 347 cells from 10 distinct populations in both of low-coverage (~0.27 million reads per cell) and high-coverage (~5 million reads per cell)"
##  classColumn: "subtype"

SRP066834:
  description: "cerebral cancer type"
  classColumn: "tissue"

SRP039694:
  description: "hepatocellular carcinoma"
  classColumn: "tissue"

SRP008976:
  description: ""
  classColumn: "disease.status"

SRP006574:
  description: ""
  classColumn: "disease.status"

SRP041736: # PROBLEM: classColumn not specfified
  description: "transcriptomes of 347 cells from 10 distinct populations in both of low-coverage (~0.27 million reads per cell) and high-coverage (~5 million reads per cell)"
  sampleIdColumn: "sample"
  classColumn: NA
  problem: "We cannot analyse this dataset because the pheno table does not contain any info about the sample classes"

SRP042161: # PROBLEM
  description: "We report transcriptomes from 430 single glioblastoma cells isolated from 5 individual tumors and 102 single cells from gliomasphere cells lines generated using SMART-seq. In addition, we report population RNA-seq from the five tumors as well as RNA-seq from cell lines derived from 3 tumors (MGH26, MGH28, MGH31) cultured under serum free (GSC) and differentiated (DGC) conditions. This dataset highlights intratumoral heterogeneity with regards to the expression of de novo derived transcriptional modules and established subtype classifiers. Overall design: Operative specimens from five glioblastoma patients (MGH26, MGH28, MGH29, MGH30, MGH31) were acutely dissociated, depleted for CD45+ inflammatory cells and then sorted as single cells (576 samples). Population controls for each tumor were isolated by sorting 2000-10000 cells and processed in parallel (5 population control samples). Single cells from two established cell lines, GBM6 and GBM8, were also sorted as single cells (192 samples). SMART-seq protocol was implemented to generate single cell full length transcriptomes (modified from Shalek, et al Nature 2013) and sequenced using 25 bp paired end reads. Single cell cDNA libraries for MGH30 were resequenced using 100 bp paired end reads to allow for isoform and splice junction reconstruction (96 samples, annotated MGH30L). Cells were also cultured in serum free conditions to generate gliomasphere cell lines for MGH26, MGH28, and MGH31 (GSC) which were then differentiated using 10% serum (DGC). Population RNA-seq was performed on these samples (3 GSC, 3 DGC, 6 total). The initial dataset included 875 RNA-seq libraries (576 single glioblastoma cells, 96 resequenced MGH30L, 192 single gliomasphere cells, 5 tumor population controls, 6 population libraries from GSC and DGC samples). Data was processed as described below using RSEM for quantification of gene expression. 5,948 genes with the highest composite expression either across all single cells combined (average log2(TPM)>4.5) or within a single tumor (average log2(TPM)>6 in at least one tumor) were included. Cells expressing less than 2,000 of these 5,948 genes were excluded. The final processed dataset then included 430 primary single cell glioblastoma transcriptomes, 102 single cell transcriptomes from cell lines(GBM6,GBM8), 5 population controls (1 for each tumor), and 6 population libraries from cell lines derived from the tumors (GSC and DGC for MGH26, MGH28 and MGH31). The final matrix (GBM_data_matrix.txt) therefore contains 5948 rows (genes) quantified in 543 samples (columns). Please note that the samples which are not included in the data processing are indicated in the sample description field.	"
  short_description: "875 runs, 430 single glioblastoma cells isolated from 5 individual tumors and 102 single cells from gliomasphere cells lines generated using SMART-seq"
  classColumn: ["patient id", "cell type", "subtype"]

# crash                "SRP042161", ##

